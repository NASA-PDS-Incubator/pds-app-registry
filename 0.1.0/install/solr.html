<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.1 from src/site/xdoc/install/solr.xml.vm at 2020-03-30
 | Rendered using Apache Maven Fluido Skin 1.8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.1" />
    <title>Registry Application &#x2013; Apache Solr</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.8.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-1.8.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="https://github.com/NASA-PDS-Incubator/pds-app-registry" id="bannerLeft"><img src="../images/pds4_logo.png"  alt=""/></a></div>
          <div class="pull-right"><div id="bannerRight"><h2>PDS Registry</h2>
</div>
</div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2020-03-30<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 0.1.0</li>
      <li class="pull-right"><a href="https://github.com/NASA-PDS-Incubator/pds-app-registry" class="externalLink" title="Registry App Github Repo">Registry App Github Repo</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Software Documentation</li>
    <li><a href="../index.html" title="About PDS Registry Application"><span class="none"></span>About PDS Registry Application</a></li>
    <li><a href="../install/index.html" title="Installation"><span class="icon-chevron-down"></span>Installation</a>
     <ul class="nav nav-list">
      <li><a href="../install/java.html" title="Java"><span class="none"></span>Java</a></li>
      <li class="active"><a href="#"><span class="none"></span>Solr</a></li>
      <li><a href="../install/tools.html" title="Tools (manager, harvest)"><span class="none"></span>Tools (manager, harvest)</a></li>
      <li><a href="../install/initialize.html" title="Initialize the registry"><span class="none"></span>Initialize the registry</a></li>
      <li><a href="../install/test.html" title="Test your deployment"><span class="none"></span>Test your deployment</a></li>
     </ul></li>
    <li><a href="../operate/index.html" title="Operation"><span class="icon-chevron-down"></span>Operation</a>
     <ul class="nav nav-list">
      <li><a href="../operate/harvest.html" title="Harvest"><span class="none"></span>Harvest</a></li>
      <li><a href="../operate/reg-manager.html" title="Registry Manager"><span class="none"></span>Registry Manager</a></li>
      <li><a href="../operate/reg-collection.html" title="Registry Collection"><span class="none"></span>Registry Collection</a></li>
      <li><a href="../operate/solr-tools.html" title="Solr Tools"><span class="none"></span>Solr Tools</a></li>
     </ul></li>
   <li class="nav-header">Downloads</li>
    <li><a href="https://github.com/NASA-PDS-Incubator/pds-app-registry/releases/download/0.1.0/pds-app-registry-0.1.0-bin.tar.gz" class="externalLink" title="Current Release (tar.gz)"><span class="none"></span>Current Release (tar.gz)</a></li>
    <li><a href="https://github.com/NASA-PDS-Incubator/pds-app-registry/releases/download/0.1.0/pds-app-registry-0.1.0-bin.zip" class="externalLink" title="Current Release (zip)"><span class="none"></span>Current Release (zip)</a></li>
    <li><a href="https://pds-engineering.jpl.nasa.gov/content/pds4-software" class="externalLink" title="Past Releases"><span class="none"></span>Past Releases</a></li>
   <li class="nav-header">Change Log</li>
    <li><a href="../" title="TBD"><span class="none"></span>TBD</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >


<section>
<h2><a name="Apache_Solr"></a>Apache Solr</h2>


<p>
PDS Registry requires <a class="externalLink" href="https://lucene.apache.org/solr/" target="_blank">Apache Solr</a>.
Solr has to be installed and started in cloud mode before running PDS Registry.

PDS Regsitry has been tested with Solr version 8.4.1.
</p>


<p>
Solr can run in two modes: 
</p>
<ul>
  
<li>Standalone</li> 
  
<li>SolrCloud</li>
</ul>



<p>
SolrCloud is the only mode supported by Registry tools.
</p>



<section>
<h3><a name="SolrCloud_Overview"></a>SolrCloud Overview</h3>

<p>
SolrCloud is a cluster of Solr servers that provides fault tolerance and high availability.
It uses Apache ZooKeeper for cluster configuration and coordination.
Number of nodes you need, usually depends on amount of data, number of queries, fault tolerance and high availability requirements.
</p>

<section>
<h4><a name="Multinode_Cluster"></a>Multinode Cluster</h4>

<p>
Below is a simplified diagram of a production setup with 3 node ZooKeeper cluster 
and multinode Solr cluster. Both ZooKeeper and Solr clusters can be expanded by adding more nodes.
This setup provides fault tolerance and high availability.
</p>
<img src="../images/solr-cluster.jpg" width="35%" alt="" />

</section><section>
<h4><a name="Single_Node_Cluster_with_Embedded_ZooKeeper"></a>Single Node Cluster with Embedded ZooKeeper</h4>

<p>
This is the simplest configuration of SolrCloud. A single instance of ZooKeeper and Solr server are running in the same JVM.
This setup does not provide any fault tolerance or high availability, and could not be expanded.
This configuration is recommended for development or testing and can be easily installed on a laptop or desktop.
</p>
<img src="../images/solr-cluster-1a.jpg" width="25%" alt="" />

</section><section>
<h4><a name="Single_Node_Cluster_with_Separate_ZooKeeper"></a>Single Node Cluster with Separate ZooKeeper</h4>

<p>
This configuration has single node ZooKeeper and single node Solr server running in different JVMs.
This setup can be easily expanded by addning more ZooKeeper or Solr nodes.
</p>

<img src="../images/solr-cluster-1b.jpg" width="30%" alt="" />
</section></section>



<section>
<h3><a name="Installation"></a>Installation</h3>

<section>
<h4><a name="Single_Node_Cluster_with_Embedded_ZooKeeper"></a>Single Node Cluster with Embedded ZooKeeper</h4>

<p>
Download ZIP or TGZ archive from <a class="externalLink" href="http://archive.apache.org/dist/lucene/solr/8.4.1">http://archive.apache.org (8.4.1)</a>
and unzip it to any directory, for example, <i>/opt/solr-8.4.1</i>. We will call this direcotry <i>SOLR_HOME</i>.
Go to <i>SOLR_HOME/bin</i> and run <i>solr.cmd</i> on Windows or <i>solr</i> on Unix or Mac. 
Pass <b>start</b> and <b>-cloud</b> parameters to start Solr in cloud mode.
</p>


<div class="source"><pre class="prettyprint">
solr start -cloud
</pre></div>


<p>
To check that Solr server started in cloud mode, open Solr Admin UI in a web browser: <i>http://localhost:8983/solr/</i>.
You should see a page similar to this.
</p>

<p>
<img src="../images/solr-adm1.jpg" width="90%" alt="" />
</p>


<p>
Check that <i>Cloud</i> menu item is available on the left. Click it. You should see a page similar to this.
</p>

<p>
<img src="../images/solr-adm2.jpg" width="85%" alt="" />
</p>

</section><section>
<h4><a name="Docker_.2F_Podman"></a>Docker / Podman</h4>

<p>
You can run Solr in Docker or Podman. Use the official Solr image from DockerHub (solr:8.4).
Map both ZooKeeper (9983) and Solr (8983) ports. 
You would need access to ZooKeeper to upload PDS registry collection configset.
Do not forget to pass <b>-cloud</b> parameter to start Solr in cloud mode.
</p>

<p>
The following example is for CentOS 8 / RHEL 8 which usually have Podman preinstalled (available in AppStream).
If your system has Docker, use <i>docker</i> command with the same parameters.
</p>

<div class="source"><pre class="prettyprint">
podman run -p 8983:8983 -p 9983:9983 -d --name solr -t solr:8.4 -cloud
</pre></div>

</section></section>

<section>
<h2><a name="Solr_in_your_network"></a>Solr in your network</h2>


<p>The Solr component of the registry is critical as it hosts the PDS records. It MUST NOT be exposed to non trusted parties (e.g. outside your organization network).
Contact your system administrators if necessary.
</p>

</section>




</section>
<section>
<h2><a name="Next_steps"></a>Next steps</h2>

<p>You Solr server is ready, you should now deploy the <a href="tools.html">tools</a> to harvest metadata and manage your registry.</p>
</section>



        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &#169;      2020..</p>
        </div>
      </div>
    </footer>
  </body>
</html>
